(window.webpackJsonp=window.webpackJsonp||[]).push([["8veI"],{"8veI":function(e,i,t){"use strict";t.r(i);t("rGqo");var a=t("WIyV"),o=t("AUoE"),l={components:{customBaseTable:a.a},name:"dialog-add",props:["initData","visible"],data:function(){return{priceType:"1",dialogLoading:!1,isVisible:!1,inDialog:!0,resState:null,openDialogName:"",showDialog:!1,inLinVisible:!1,dialogData:{fullscreen:!1,title:"",data:null},tableData:[],apiObj:{apiName:"listPageOrderDetailQueryByDeliver",params:{ids:"",fieldCode:"prodInfo,orderUnitName,orderCount,needDeliverCount,notDeliverCount,orderDtlDeliverCount,productPrice,productSum,deliverDtlRemark",addColumn:{columnKey:"prodInfo",columnName:"货品"},prodColumnKey:"productCode,productName,productSpec,productProperty"}},customColumn:[{columnIndex:"prodInfo",width:"200",_cellConfig:{hideTitle:!0}},{columnIndex:"orderDtlDeliverCount",componentName:"input",_cellConfig:{rules:[{regexp:"^[0-9]+\\.{0,1}[0-9]{0,2}$"},{greaterThan:["0",!1]},{lessThan:["self@notDeliverCount",!0]}],message:["请输入数字！","必须大于零！","必须小于未发货数量！"]}},{columnIndex:"deliverDtlRemark",componentName:"input",_cellConfig:{}}],mergeTitle:[],mergeColumn:[],mergeRow:[],keyMapping:{}}},created:function(){var e=this.initData.orderDtlIds;this.apiObj.params.ids=e},mounted:function(){this.dialogLoading=!1,this.isVisible=this.visible},computed:{fullscreen:function(){return!!this.initData.fullscreen},onModal:function(){return!!this.initData["close-on-click-modal"]},onEscape:function(){return!!this.initData["close-on-press-escape"]},dialogName:function(){return this.openDialogName}},methods:{getData:function(){this.$refs.addDeliverDialog.getData()},databridge:function(e){Array.isArray(e)&&(this.tableData=[],this.tableData=e)},dialogOpen:function(){},closeDialog:function(e){},dialogClose:function(e){this.$emit("close-dialog",e||{})},saveSaleDeliver:function(){var e=this;if(this.getData(),null!=this.tableData&&this.tableData.length>0){var i=[];this.tableData.forEach(function(e){i.push(e)});var t=JSON.stringify(i);this.dialogLoading=!0,Object(o.addSaleDeliver)({roleId:this.$storage.get("userInfo").roleIds,priceType:this.priceType,dtlJsonStr:t}).then(function(i){0===i.code&&(e.dialogLoading=!1,e.$notify({title:"成功",message:"保存成功",type:"success",duration:2e3}),e.isVisible=!1,e.dialogClose({resState:"ok"}))}).catch(function(i){e.dialogLoading=!1})}}}},n=t("KHd+"),r=Object(n.a)(l,function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:e.initData.title?e.initData.title:"",visible:e.isVisible,"append-to-body":e.inDialog,"close-on-click-modal":e.onModal,"close-on-press-escape":e.onEscape,fullscreen:e.fullscreen,width:"1200px"},on:{"update:visible":function(i){e.isVisible=i},open:e.dialogOpen,close:e.dialogClose}},[e.showDialog?t(e.dialogName,{tag:"component",attrs:{initData:e.dialogData,visible:e.inLinVisible},on:{"close-dialog":e.closeDialog}}):e._e(),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}]},[t("el-row",{staticStyle:{padding:"10px"}},[t("custom-base-table",{ref:"addDeliverDialog",attrs:{"data-custom-table-id":"views_sale_deliver_createDeliver_dialogAddDeliverDetail0",isSortable:!1,keyValue:!1,showIndex:!0,showTableSet:!1,customColumn:e.customColumn,apiObj:e.apiObj,mergeTitle:e.mergeTitle,mergeColumn:e.mergeColumn,mergeRow:e.mergeRow,componentId:"addDeliverDialog",useDefaultBtn:!0,showAll:!1,keyMapping:e.keyMapping},on:{databridge:e.databridge}})],1),e._v(" "),t("el-row",{staticStyle:{height:"100px","text-align":"center"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.saveSaleDeliver}},[e._v("保存")]),e._v(" "),t("el-button",{on:{click:function(i){e.isVisible=!1}}},[e._v("关闭")])],1)],1)],1)},[],!1,null,null,null);r.options.__file="dialogAddDeliverDetail.vue";i.default=r.exports}}]);