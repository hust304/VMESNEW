(window.webpackJsonp=window.webpackJsonp||[]).push([["FgPX"],{FgPX:function(e,t,o){"use strict";o.r(t);o("rGqo"),o("yt8O"),o("RW0V"),o("Yfch");var r=o("L2JU"),n=o("XS0u");function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}t.default={data:function(){var e=this;return{loginForm:{username:"",password:"",authcode:""},loginRules:{username:[{required:!0,trigger:"blur",validator:function(e,t,o){t.trim()?o():o(new Error("请输入正确的用户名"))}}],password:[{required:!0,trigger:"blur",validator:function(e,t,o){t.length<0?o(new Error("密码不能小于5位")):o()}}],authcode:[{required:!0,trigger:"blur",validator:function(t,o,r){var n=o.toUpperCase();n&&e.authcode?n!==e.authcode?r(new Error("验证码错误")):r():r(new Error("验证码不匹配"))}}]},loading:!1,pwdType:"password",checked:!1,lading:null,codeTimer:""}},created:function(){var e=n.a.localGet("auth")||{};e.password&&(this.loginForm.username=e.username,this.loginForm.password=e.password,this.checked=!0),this.$loading(),this.changeCode(),this.$loading({}).close()},mounted:function(){},methods:{showPwd:function(){"password"===this.pwdType?this.pwdType="":this.pwdType="password"},handleLogin:function(){var e=this,t=this;t.savePwd(t.checked),t.$refs.loginForm.validate(function(o){if(!o)return console.log("error submit!!"),!1;t.loading=!0,t.$store.dispatch("Login",e.loginForm).then(function(e){clearTimeout(t.codeTimer),t.loading=!1,t.$store.dispatch("tagsView/delAllViews").then(function(e){e.visitedViews}),t.$router.push({path:"/home"})}).catch(function(){t.loading=!1,t.$loading({}).close()})})},savePwd:function(e){if(e){var t={username:this.loginForm.username,password:this.loginForm.password};console.log(t),n.a.localSet("auth",t)}else n.a.localRemove("auth")},changeCode:function(){var e=this;e.$store.dispatch("CreateSecurityCode",{}).then(function(){e.$refs.loginForm&&e.$refs.loginForm.clearValidate&&e.$refs.loginForm.clearValidate(),e.loginForm.authcode="",e.drawPic(e.authcode),clearTimeout(e.codeTimer),e.codeTimer=setTimeout(function(t){e.changeCode()},27e3)}).catch(function(){e.$refs.loginForm&&e.$refs.loginForm.clearValidate&&e.$refs.loginForm.clearValidate(),clearTimeout(e.codeTimer),e.codeTimer=setTimeout(function(t){e.changeCode()},27e3)})},drawPic:function(e){var t=document.getElementById("canvas"),o=t.width,r=t.height,n=t.getContext("2d");function i(e,t){return Math.floor(Math.random()*(t-e)+e)}function a(e,t){return"rgb("+i(e,t)+","+i(e,t)+","+i(e,t)+")"}n.textBaseline="bottom",n.fillStyle=a(180,240),n.fillRect(0,0,o,r);for(var c=e,l=0;l<4;l++){var s=c[l];n.fillStyle=a(50,160),n.font=i(18,30)+"px SimHei";var u=5+20*l,d=i(25,30),h=i(-30,30);n.translate(u,d),n.rotate(h*Math.PI/180),n.fillText(s,0,0),n.rotate(-h*Math.PI/180),n.translate(-u,-d)}}},computed:function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{},r=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(o).filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}))),r.forEach(function(t){i(e,t,o[t])})}return e}({},Object(r.b)(["authcode"]),{btnState:function(){return!(this.loginForm.username&&this.loginForm.password&&this.loginForm.authcode)}}),watch:{checked:function(){this.checked||n.a.localRemove("auth")}}}}}]);