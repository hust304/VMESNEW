(window.webpackJsonp=window.webpackJsonp||[]).push([["R19T"],{R19T:function(e,t,a){"use strict";a.r(t);var i=a("2+ib"),l=a("+Dad"),n={components:{multilevelTable:i.a},name:"dialog-add",props:["initData","visible"],data:function(){return{planId:"",planDtlId:"",rules:{},openDialogName:"",showDialog:!1,inLinVisible:!1,dialogData:{title:"",data:null,tempLable:null},dialogLoading:!1,isVisible:!1,inDialog:!0,tableList:[],tableConfigList:[{customColumn:[{columnIndex:"sysCode"},{columnIndex:"produceTypeName"},{columnIndex:"makeName"},{columnIndex:"planStateName"}],mergeTitle:[{index:2,alias:"",columns:["beginDate","endDate"]}],apiObj:{apiName:"listPageProducePlan",params:{fieldCode:"sysCode,beginDate,endDate,produceTypeName,makeName,planStateName",planId:"",orderStr:"plan.cdate desc"}},tempData:{},showHeader:!1,showIndex:!1,showCheckBox:!1,showTableSet:!1,showAll:!1,componentId:"oneLevelTable",expand:!0,rowStyle:{"background-color":"#dfe6ec"}},{customColumn:[{columnIndex:"fineCount",componentName:"input",_cellConfig:{rules:[{greaterThan:["0",!1]},{regexp:"^[0-9]+([.]{1}[0-9]{1,2})?$"},{lessThan:["self@count",!0]}],message:["合格数必须大于零！","请输入大于零的正整数或(1,2)位小数！","不可大于计划数量"]}},{columnIndex:"badCount",componentName:"input",_cellConfig:{rules:[{regexp:"^[0-9]+([.]{1}[0-9]{1,2})?$"},{lessThan:["self@count",!0]}],message:["请输入大于零的正整数或(1,2)位小数！","不可大于计划数量"]}}],apiObj:{apiName:"listPageProducePlanDetailByQuality",params:{fieldCode:"code,productCode,productName,productSpec,productProperty,unitName,count,fineCount,badCount,stateName",ids:"",inStates:"0,1",isNeedPage:"false"}},dynamicValue:{parentId:"self@id"},tempData:{},showIndex:!1,showCheckBox:!1,isSingle:!1,componentId:"twoLevelTable"}]}},created:function(){this.planId=this.initData.planId,this.planDtlId=this.initData.planDtlId,this.tableConfigList[0].apiObj.params.planId=this.planId,this.tableConfigList[1].apiObj.params.ids=this.planDtlId},mounted:function(){this.isVisible=this.visible},computed:{fullscreen:function(){return!!this.initData.fullscreen},onModal:function(){return!!this.initData["close-on-click-modal"]},onEscape:function(){return!!this.initData["close-on-press-escape"]},dialogName:function(){return this.openDialogName}},methods:{callMethod:function(e){e&&e.methodName&&this[e.methodName](e.params)},databridge:function(e){Array.isArray(e)&&(this.tableList=[],this.tableList=e)},getData:function(){this.$refs.producePlanQuality.getData()},deleteData:function(e){this.$refs.producePlanQuality.deleteData(e)},dialogOpen:function(){},dialogClose:function(e){this.$emit("close-dialog",e||{})},save:function(){var e=this;this.getData();var t=[];null!=this.tableList&&this.tableList.length>0&&null!=this.tableList[0]&&null!=this.tableList[0].children&&(t=this.tableList[0].children);var a=[];if(0!=t.length){for(var i=0;i<t.length;i++){var n=t[i],o={planId:n.parentId,planDtlId:n.id,productId:n.productId,unitId:n.unitId,fineCount:n.fineCount,badCount:n.badCount};a.push(o)}var s=JSON.stringify(a);this.dialogLoading=!0,Object(l.addProducePlanDetailByQuality)({planId:this.planId,deptId:this.$storage.get("userInfo").deptId,roleId:this.$storage.get("userInfo").roleIds,jsonStr:s}).then(function(t){e.dialogLoading=!1,0===t.code&&(e.$notify({title:"成功",message:"报工成功",type:"success",duration:2e3}),e.isVisible=!1,e.dialogClose({resState:"ok"}))}).catch(function(t){e.dialogLoading=!1})}},closeDialog:function(e){}},watch:{}},o=a("KHd+"),s=Object(o.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:e.initData.title?e.initData.title:"",visible:e.isVisible,"append-to-body":e.inDialog,"close-on-click-modal":e.onModal,"close-on-press-escape":e.onEscape,fullscreen:e.fullscreen,width:"1200px"},on:{"update:visible":function(t){e.isVisible=t},open:e.dialogOpen,close:e.dialogClose}},[e.showDialog?a(e.dialogName,{tag:"component",attrs:{initData:e.dialogData,visible:e.inLinVisible},on:{"close-dialog":e.closeDialog}}):e._e(),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}]},[a("el-row",{staticStyle:{width:"96%","margin-left":"2%"}},[a("multilevel-table",{ref:"producePlanQuality",attrs:{"data-custom-table-id":"views_produce_producePlanQuality_dialogAdd0",tableConfigList:e.tableConfigList},on:{callmethod:e.callMethod,databridge:e.databridge}})],1),e._v(" "),a("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center","padding-bottom":"10px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]),e._v(" "),a("el-button",{on:{click:function(t){e.isVisible=!1}}},[e._v("关闭")])],1)],1)],1)},[],!1,null,null,null);s.options.__file="dialogAdd.vue";t.default=s.exports}}]);