(window.webpackJsonp=window.webpackJsonp||[]).push([["W3AZ"],{W3AZ:function(e,i,t){"use strict";t.r(i);var a=t("2+ib"),o=t("vR9m"),l={components:{multilevelTable:a.a},props:["initData","visible"],data:function(){return{addDeliverData:{orderId:"",deliverDetail:"",deliverDetailChild:""},rules:{},openDialogName:"",showDialog:!1,inLinVisible:!1,dialogData:{title:"",data:null},dialogLoading:!0,isVisible:!1,inDialog:!0,tableData:[],tableConfigList:[{customColumn:[],apiObj:{apiName:"listPageAssistOrderDetail",params:{fieldCode:"supplierName,assistProductName,craftName,orderUnitName,orderCount",orderDtlId:""}},tempData:{},showHeader:!0,showIndex:!1,showCheckBox:!1,showTableSet:!1,showAll:!1,componentId:"oneLevelTable",expand:!0,expandMode:"all",rowStyle:{"background-color":"#dfe6ec"}},{customColumn:[{columnIndex:"editDeliverCount",componentName:"input",_cellConfig:{rules:[{regexp:"^[0-9]+([.]{1}[0-9]{1,2})?$"},{lessThan:["self@maxDeliverCount",!0]}],message:["请输入大于零的正整数或(1,2)位小数！","不可大于最大发货数量！"]}}],apiObj:{apiName:"listPageAssistOrderDetailChildByDeliver",params:{fieldCode:"prodInfo,unitName,ratio,count,deliverCount,maxDeliverCount,editDeliverCount",addColumn:{columnKey:"prodInfo,editDeliverCount",columnName:"货品,本次发货"},prodColumnKey:"productCode,productName,productSpec,productProperty",orderDtlId:"",isNeedPage:"false"}},dynamicValue:{parentId:"self@id"},tempData:{},showIndex:!1,showCheckBox:!1,isSingle:!1,rightFixed:0,componentId:"twoLevelTable"}]}},beforeCreate:function(){},created:function(){var e=this.initData.rowData;this.tableConfigList[0].apiObj.params.orderDtlId=e.id,this.tableConfigList[1].apiObj.params.orderDtlId=e.id,this.addDeliverData.orderId=e.parentId},beforeMount:function(){},mounted:function(){this.dialogLoading=!1,this.isVisible=this.visible},beforeUpdate:function(){},updated:function(){},methods:{callMethod:function(e){e&&e.methodName&&this[e.methodName](e.params)},databridge:function(e){Array.isArray(e)&&(this.tableData=[],this.tableData=e)},getData:function(){this.$refs.customBaseTable.getData()},dialogOpen:function(){},dialogClose:function(e){this.$emit("close-dialog",e||{})},closeDialog:function(e){},findJsonStringByTable:function(e){var i=e[0],t={orderId:i.parentId,orderDetailId:i.id,assistProductId:i.assistProductId,orderUnit:i.orderUnit};this.addDeliverData.deliverDetail=JSON.stringify(t);for(var a=[],o=i.children,l=0;l<o.length;l++){var n=o[l],d={orderDtlChildId:n.orderDtlChildId,productId:n.productId,unitId:n.unitId,ratio:n.ratio,count:n.editDeliverCount};a.push(d)}this.addDeliverData.deliverDetailChild=JSON.stringify(a)},save:function(){var e=this;this.getData(),null!=this.tableData&&this.tableData.length>0&&(this.findJsonStringByTable(this.tableData,this.addDeliverData),this.dialogLoading=!0,Object(o.addAssistDeliver)(this.addDeliverData).then(function(i){0===i.code&&(e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3}),e.dialogLoading=!1,e.isVisible=!1,e.dialogClose({resState:"ok"}))}).catch(function(i){e.dialogLoading=!1}))}},computed:{fullscreen:function(){return!!this.initData.fullscreen},onModal:function(){return!!this.initData["close-on-click-modal"]},onEscape:function(){return!!this.initData["close-on-press-escape"]},dialogName:function(){return this.openDialogName}},watch:{}},n=t("KHd+"),d=Object(n.a)(l,function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:e.initData.title?e.initData.title:"",visible:e.isVisible,"append-to-body":e.inDialog,"close-on-click-modal":e.onModal,"close-on-press-escape":e.onEscape,fullscreen:e.fullscreen,width:"1000px"},on:{"update:visible":function(i){e.isVisible=i},open:e.dialogOpen,close:e.dialogClose}},[e.showDialog?t(e.dialogName,{tag:"component",attrs:{initData:e.dialogData,visible:e.inLinVisible},on:{"close-dialog":e.closeDialog}}):e._e(),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}],staticStyle:{padding:"20px 20px 0px 20px"}},[t("el-row",[t("multilevel-table",{ref:"customBaseTable",attrs:{"data-custom-table-id":"views_assist_assistDeliver_createAssistDeliver_dialogAdd0",tableConfigList:e.tableConfigList},on:{callmethod:e.callMethod,databridge:e.databridge}})],1),e._v(" "),t("div",{staticStyle:{"text-align":"center",padding:"10px 0px 20px 0px"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]),e._v(" "),t("el-button",{on:{click:function(i){e.isVisible=!1}}},[e._v("关闭")])],1)],1)],1)},[],!1,null,null,null);d.options.__file="dialogAdd.vue";i.default=d.exports}}]);