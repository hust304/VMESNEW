(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4ae1","FgPX"],{"7Zgp":function(e,t,o){e.exports=o.p+"static/img/ouhaiglasses.6c773bd.png"},CNWH:function(e,t,o){},FgPX:function(e,t,o){"use strict";o.r(t);o("rGqo"),o("yt8O"),o("RW0V"),o("Yfch");var a=o("L2JU"),n=o("XS0u");o("yO6P");function r(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}t.default={data:function(){var e=this;return{loginForm:{username:"",password:"",authcode:""},loginRules:{username:[{required:!0,trigger:"blur",validator:function(e,t,o){t.trim()?/^[A-Za-z0-9_]{1,}$/.test(t)?o():o(new Error("仅限输入英文，数字，下划线")):o(new Error("请输入正确的用户名"))}}],password:[{required:!0,trigger:"blur",validator:function(e,t,o){t.trim()?t.length<0?o(new Error("密码长度过低")):o():o(new Error("请输入密码"))}}],authcode:[{required:!0,trigger:"blur",validator:function(t,o,a){var n=o.toUpperCase();n&&e.authcode?n!==e.authcode?a(new Error("验证码错误")):a():a(new Error("验证码不匹配"))}}]},loading:!1,pwdType:"password",checked:!1,lading:null,codeTimer:"",userKey:""}},created:function(){var e=this,t=n.a.localGet("auth")||{};e.$loading(),t.password&&(e.loginForm.username=t.username,e.loginForm.password=t.password,e.checked=!0),e.userKey=n.a.localGet("tempUserKey")||"",n.a.localRemove("tempUserKey"),e.userKey&&e.$api.findUserCodeByToken({token:e.userKey}).then(function(t){e.loginForm.username=t.userCode,e.loginForm.password="123456",e.checked=!1}).catch(function(t){e.loginForm.username="",e.loginForm.password="",e.checked=!1}),e.changeCode(),e.$loading({}).close()},mounted:function(){},methods:{showPwd:function(){this.userKey||("password"===this.pwdType?this.pwdType="":this.pwdType="password")},handleLogin:function(){var e=this;e.savePwd(e.checked),e.$refs.loginForm.validate(function(t){if(!t)return console.log("error submit!!"),!1;e.loading=!0,e.$store.dispatch("Login",{userInfo:e.loginForm,token:e.userKey}).then(function(t){clearTimeout(e.codeTimer),e.loading=!1,e.$store.dispatch("tagsView/delAllViews").then(function(e){e.visitedViews}),e.$router.push({path:"/home"})}).catch(function(){e.loading=!1,e.$loading({}).close()})})},savePwd:function(e){if(e){var t={username:this.loginForm.username,password:this.loginForm.password};console.log(t),n.a.localSet("auth",t)}else n.a.localRemove("auth")},changeCode:function(){var e=this;e.$store.dispatch("CreateSecurityCode",{}).then(function(){e.$refs.loginForm&&e.$refs.loginForm.clearValidate&&e.$refs.loginForm.clearValidate(),e.loginForm.authcode="",e.drawPic(e.authcode),clearTimeout(e.codeTimer),e.codeTimer=setTimeout(function(t){e.changeCode()},27e3)}).catch(function(){e.$refs.loginForm&&e.$refs.loginForm.clearValidate&&e.$refs.loginForm.clearValidate(),e.loginForm.authcode="",clearTimeout(e.codeTimer),e.codeTimer=setTimeout(function(t){e.changeCode()},27e3)})},drawPic:function(e){var t=document.getElementById("canvas"),o=t.width,a=t.height,n=t.getContext("2d");function r(e,t){return Math.floor(Math.random()*(t-e)+e)}function i(e,t){return"rgb("+r(e,t)+","+r(e,t)+","+r(e,t)+")"}n.textBaseline="bottom",n.fillStyle=i(180,240),n.fillRect(0,0,o,a);for(var s=e,l=0;l<4;l++){var c=s[l];n.fillStyle=i(50,160),n.font=r(18,30)+"px SimHei";var u=5+20*l,d=r(25,30),h=r(-30,30);n.translate(u,d),n.rotate(h*Math.PI/180),n.fillText(c,0,0),n.rotate(-h*Math.PI/180),n.translate(-u,-d)}}},computed:function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{},a=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(o).filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}))),a.forEach(function(t){r(e,t,o[t])})}return e}({},Object(a.b)(["authcode"]),{btnState:function(){return!(this.loginForm.username&&this.loginForm.password&&this.loginForm.authcode&&this.loginForm.authcode.toLowerCase()===this.authcode.toLowerCase())}}),watch:{checked:function(){this.checked||n.a.localRemove("auth")}}}},S3Uu:function(e,t,o){"use strict";var a=o("e4tl");o.n(a).a},e4tl:function(e,t,o){},l7u9:function(e,t,o){"use strict";var a=o("CNWH");o.n(a).a},pLN4:function(e,t,o){"use strict";o.r(t);var a=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"clearfix",staticStyle:{float:"left",width:"50%",height:"100%",position:"relative"}},[t("div",{staticStyle:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",width:"70%",height:"auto"}},[t("img",{staticStyle:{width:"100%",height:"auto"},attrs:{src:o("7Zgp")}})])])}],n={name:"login",mixins:[o("FgPX").default]},r=(o("l7u9"),o("S3Uu"),o("KHd+")),i=Object(r.a)(n,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"login-container"},[e._m(0),e._v(" "),o("div",{staticClass:"clearfix",staticStyle:{float:"left",width:"50%",height:"100%",position:"relative","background-color":"rgb(191,191,191)"}},[o("div",{staticStyle:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",width:"100%",height:"655px"}},[o("div",{staticStyle:{height:"100%",position:"relative"}},[o("p",{staticStyle:{"text-align":"center","font-size":"5vh","font-weight":"600","letter-spacing":"5px"}},[e._v("瓯海区眼镜企业")]),e._v(" "),o("p",{staticStyle:{"text-align":"center","font-size":"5vh","font-weight":"600","letter-spacing":"5px"}},[e._v("运营管理系统")]),e._v(" "),o("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{autoComplete:"on",model:e.loginForm,rules:e.loginRules,"label-position":"left","status-icon":""}},[o("el-form-item",{attrs:{prop:"username"}},[o("span",{staticClass:"svg-container svg-container_login"},[o("svg-icon",{attrs:{"icon-class":"user"}})],1),e._v(" "),o("el-input",{attrs:{name:"username",type:"text",clearable:"",autoComplete:"on",placeholder:"请输入用户名"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"password"}},[o("span",{staticClass:"svg-container"},[o("svg-icon",{attrs:{"icon-class":"password"}})],1),e._v(" "),o("el-input",{attrs:{name:"password",type:e.pwdType,clearable:"",autoComplete:"on",placeholder:"请输入密码"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}}),e._v(" "),o("span",{staticClass:"show-pwd",attrs:{title:e.$t("base.showPwd")},on:{click:e.showPwd}},[o("svg-icon",{directives:[{name:"show",rawName:"v-show",value:e.pwdType,expression:"pwdType"}],attrs:{"icon-class":"eye"}}),o("svg-icon",{directives:[{name:"show",rawName:"v-show",value:!e.pwdType,expression:"!pwdType"}],attrs:{"icon-class":"eye_open"}})],1)],1),e._v(" "),o("el-form-item",{staticClass:"loginCss",attrs:{prop:"authcode"}},[o("el-input",{staticStyle:{width:"60%",border:"2px solid rgba(217, 217, 217, 1)","border-radius":"5px"},attrs:{type:"text",clearable:"",name:"authcode",placeholder:"请输入右侧验证码"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleLogin(t):null}},model:{value:e.loginForm.authcode,callback:function(t){e.$set(e.loginForm,"authcode",t)},expression:"loginForm.authcode"}}),e._v(" "),o("div",{attrs:{id:"authcodeBox"}},[o("div",{attrs:{id:"canvasBox"}},[o("canvas",{directives:[{name:"show",rawName:"v-show",value:e.authcode,expression:"authcode"}],attrs:{id:"canvas",width:"83",height:"32",title:"点击更换验证码"},on:{click:e.changeCode}}),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!e.authcode,expression:"!authcode"}],staticStyle:{height:"100%","text-align":"center","background-color":"#e0e0e0",cursor:"pointer"},on:{click:e.changeCode}},[e._v("获取验证码")])])])],1),e._v(" "),o("el-form-item",{staticClass:"loginCss"},[o("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.loading,disabled:e.btnState},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin(t)}}},[e._v("\n                登 录\n              ")])],1),e._v(" "),o("div",{staticClass:"tips"},[o("el-checkbox",{staticStyle:{color:"#fff"},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("记住密码")])],1)],1)],1)])])])},a,!1,null,"04fbcb03",null);i.options.__file="index.vue";t.default=i.exports}}]);