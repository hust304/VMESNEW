(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-73df"],{"41Jx":function(t,e,a){"use strict";a.r(e);a("rGqo");var i=a("2+ib"),n=a("uTIz"),o=a("aAJ4"),s=a("To5H"),l=a("m3FM"),c=a("fYoi"),d=a("WEiI"),u=a("Vobf"),r=a("QFMg"),h={components:{multilevelTable:i.a,searchBar:n.a,dialogMaintainReceive:o.default,dialogProductReceive:s.default,dialogProductConfirm:l.default,dialogMaintainTask:c.default,dialogCancel:d.default},data:function(){return{searchList:[{label:"设备编码",type:"input",ruleType:"string",mapKey:"equipmentCode",configs:{},placeholder:"设备编码"},{label:"设备名称",type:"input",ruleType:"string",mapKey:"equipmentName",configs:{},placeholder:"设备名称"},{label:"状态",type:"select",ruleType:"string",mapKey:"equipmentState",configs:{clearable:!0,name:"",options:[{value:"1",label:"待保养"},{value:"2",label:"保养中"},{value:"3",label:"已完成"}]},placeholder:"请选择"}],searchObj:{},guid:"",tableConfigList:[{customColumn:[{columnIndex:"state",width:"140",componentName:"tag",_cellConfig:{success:{state:"3",text:"已完成"},info:{state:"2",text:"保养中"},default:{state:"1",text:"待保养"}}},{columnIndex:"last",prop:"operate",label:"操作",componentName:"button",component:[{name:"保养",nameEn:"maintainReceive",editBtns_isShow:!0,rowState:"#self@equipmentState#===1",method:this.maintainReceive},{name:"领料",nameEn:"productReceive",editBtns_isShow:!0,rowState:"#self@equipmentState#===2",method:this.productReceive},{name:"报工",nameEn:"productConfirm",editBtns_isShow:!0,rowState:"#self@equipmentState#===2",method:this.productConfirm},{name:"退单",nameEn:"cancelTask",editBtns_isShow:!0,rowState:"#self@equipmentState#===2 && #self@taskState#===1",method:this.cancelTask},{name:"查看详情",nameEn:"maintainTask",editBtns_isShow:!0,method:this.maintainTask}]}],apiObj:{apiName:"listPageEquipmentMaintain",params:{fieldCode:"sysCode,code,name,spec,maintainContent,modeName,isStopName,beginTimeStr,endTimeStr,maintainUserName,equipmentStateName",dataType:this.$storage.get("dataType"),orderStr:"maintain.cdate desc"}},tempData:{},showHeader:!0,showIndex:!0,showCheckBox:!1,showTableSet:!1,showAll:!1,componentId:"oneLevelTable"}],openDialogName:"",showDialog:!1,visible:!1,dialogData:{dialog_width:"",table_style:"",maintainId:"",maintainTaskId:"",title:""}}},beforeCreate:function(){},created:function(){this.initButtons()},beforeMount:function(){},mounted:function(){},beforeUpdate:function(){},updated:function(){},methods:{initButtons:function(){var t=this,e=t.$storage.get("userInfo").roleIds,a=t.$storage.get("menuId");e&&(t.$loading({spinner:"preloader",text:""}),Object(u.initMenuButtons)({menuId:a,roleId:e}).then(function(e){t.$loading().close();var a=e.buttonList;a&&a.forEach(function(e){t.configs&&(t.configs.queryBarBtnList&&t.configs.queryBarBtnList.forEach(function(t){t.nameEn==e.nameEn&&(t.isShow=!1)}),t.configs.topBarBtnList&&t.configs.topBarBtnList.forEach(function(t){t.nameEn==e.nameEn&&(t.isShow=!1)})),t.tableConfigList&&t.tableConfigList.forEach(function(t){t.customColumn&&t.customColumn.forEach(function(t){"last"==t.columnIndex&&t.component&&t.component.forEach(function(t){t.nameEn==e.nameEn&&(t.rowState="1==2")})})})})}).catch(function(e){t.$loading().close()}))},databridge:function(t){},getData:function(){this.$refs.customBaseTable.getData()},pushData:function(t,e){this.$refs.customBaseTable.pushData(t,e)},updateData:function(t){this.$refs.customBaseTable.updateData(t)},deleteData:function(t){this.$refs.customBaseTable.deleteData(t)},callMethod:function(t){t&&t.methodName&&this[t.methodName](t.params)},sendGuid:function(t){this.guid=t},searchMap:function(t){this.searchObj=t,this.updateData(this.searchObj)},closeDialog:function(t){this.showDialog=!1,"ok"===t.resState&&this.updateData(this.searchObj)},maintainReceive:function(t){this.dialogData.maintainId=t.id,this.dialogData.title="领取保养单",this.openDialogName="dialogMaintainReceive",this.showDialog=!0,this.visible=!0},productReceive:function(t){this.dialogData.maintainTaskId=t.maintainTaskId,this.dialogData.title="领取保养货品",this.openDialogName="dialogProductReceive",this.showDialog=!0,this.visible=!0},productConfirm:function(t){var e=this;Object(r.findIsAllOutExecuteByMaintain)({maintainTaskId:t.maintainTaskId}).then(function(a){"true"==a.isAllOut?(e.dialogData.maintainTaskId=t.maintainTaskId,e.dialogData.title="保养货品报工",e.openDialogName="dialogProductConfirm",e.showDialog=!0,e.visible=!0):"false"==a.isAllOut&&e.$message({type:"warning",duration:5e3,showClose:!0,message:"当前保养任务(领料出库单)未执行完成，不可(报工)操作！备注：通过(查看详情-货品详情-领取货品状态)查看领料出库状态"})}).catch(function(t){})},cancelTask:function(t){this.dialogData.maintainId=t.id,this.dialogData.maintainTaskId=t.maintainTaskId,this.dialogData.planId=t.planId,this.dialogData.title="取消保养任务",this.openDialogName="dialogCancel",this.showDialog=!0,this.visible=!0},maintainTask:function(t,e){var a=.6*document.body.clientWidth;this.dialogData.dialog_width=a+"px";var i=.75*(.618*a)+"px";this.dialogData.table_style="height:"+i+";width: 96%;margin-left: 2%;",this.dialogData.maintainId=t.id,this.openDialogName="dialogMaintainTask",this.dialogData.title="查看详情",this.showDialog=!0,this.visible=!0}},computed:{tableHeight:function(){return this.$store.getters[this.guid+"/clientData"]?this.$store.getters[this.guid+"/clientData"].clientHeight-(this.searchList.length?this.$store.getters[this.guid+"/dynaHeight"]+30-this.$store.getters[this.guid+"/arrowBtn"]:0):0},dialogName:function(){return this.openDialogName}},watch:{}},m=(a("WLEP"),a("jFcm"),a("KHd+")),g=Object(m.a)(h,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"equipmentMaintain"},[t.searchList.length?a("search-bar",{attrs:{searchList:t.searchList},on:{"search-map":t.searchMap,"send-guid":t.sendGuid}}):t._e(),t._v(" "),a("el-row",{staticStyle:{border:"1px solid #E4E4E4","border-bottom":"none","margin-top":"10px",transition:"height 0.4s","-webkit-transition":"height 0.4s","-moz-transition":"height 0.4s"},style:{height:t.tableHeight+"px"}},[a("el-col",{staticClass:"tableStyle"},[a("div",{staticClass:"baseTable"},[a("el-row",{staticClass:"tableContent"},[a("multilevel-table",{ref:"customBaseTable",attrs:{"data-custom-table-id":"views_equipment_equipmentMaintain_maintain_index0",tableConfigList:t.tableConfigList},on:{callmethod:t.callMethod,databridge:t.databridge}})],1)],1)])],1),t._v(" "),t.showDialog?a(t.dialogName,{tag:"component",attrs:{initData:t.dialogData,visible:t.visible},on:{"close-dialog":t.closeDialog}}):t._e()],1)},[],!1,null,null,null);g.options.__file="index.vue";e.default=g.exports},WLEP:function(t,e,a){"use strict";var i=a("kMWg");a.n(i).a},jFcm:function(t,e,a){"use strict";var i=a("ouu9");a.n(i).a},kMWg:function(t,e,a){},ouu9:function(t,e,a){}}]);