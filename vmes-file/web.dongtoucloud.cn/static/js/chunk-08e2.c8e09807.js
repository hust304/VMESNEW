(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-08e2"],{MTY6:function(t,e,i){},NVVL:function(t,e,i){"use strict";var n=i("fcVt");i.n(n).a},S59M:function(t,e,i){"use strict";i.r(e);i("f3/d");var n=i("uTIz"),a=i("z0WU"),s=i("gepB"),o={data:function(){return{loading:!0,viewWidth:0,dialogVisible:!1,searchList:[{label:"看板名称",type:"input",ruleType:"string",mapKey:"kanbanName",configs:{},placeholder:"请输入名称"}],guid:"",searchName:"",kanbanList:[],userSelectLayout:null}},components:{searchBar:n.a,visualizationTemplate:s.a},created:function(){this.httpRequest()},mounted:function(){this.viewWidth=this.$el.clientWidth},methods:{sendGuid:function(t){this.guid=t},searchMap:function(t){console.log(t),this.searchName=t.kanbanName||""},httpRequest:function(){var t=this;this.loading=!0,setTimeout(function(e){t.kanbanList=t.$storage.get("tempLayouts")||[],t.loading=!1},2e3)},createName:function(t,e,i){return t&&"default"!==t?t:(i.name="看板".concat(Object(a.q)(e+1)),i.name)},removeLayout:function(t,e){this.kanbanList.splice(e,1),this.$storage.set("tempLayouts",this.kanbanList)},previewLayout:function(t){this.userSelectLayout=t,this.dialogVisible=!0},closeview:function(){this.dialogVisible=!1,this.userSelectLayout=null},createLayout:function(){this.$router.push({path:"/encapsulation/visualization/customKanban"})}},computed:{tableHeight:function(){return this.$store.getters[this.guid+"/clientData"]?this.$store.getters[this.guid+"/clientData"].clientHeight-(this.searchList.length?this.$store.getters[this.guid+"/dynaHeight"]+30-this.$store.getters[this.guid+"/arrowBtn"]:0)+"px":"100%"},setKanbanList:function(){var t=this;return this.kanbanList.filter(function(e){return!t.searchName||(!e.name||"default"===e.name||e.name.indexOf(t.searchName)>-1)})},setSpan:function(){return this.viewWidth?24/(Math.ceil(this.viewWidth/800)+1):6}},watch:{}},l=(i("NVVL"),i("KHd+")),u=Object(l.a)(o,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"kanbanList"},[t.searchList.length?i("search-bar",{attrs:{searchList:t.searchList},on:{"search-map":t.searchMap,"send-guid":t.sendGuid}}):t._e(),t._v(" "),i("el-row",{staticStyle:{"border-bottom":"none","margin-top":"10px",transition:"height 0.4s","-webkit-transition":"height 0.4s","-moz-transition":"height 0.4s",overflow:"auto"},style:{height:t.tableHeight,"margin-top":t.searchList.length?"10px":"0"}},[t.kanbanList.length?t._l(t.setKanbanList,function(e,n){return i("el-col",{key:n,staticStyle:{padding:"1vh"},attrs:{span:t.setSpan}},[i("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"hover"}},[i("div",{staticStyle:{padding:"1.5vh","text-align":"center"},domProps:{textContent:t._s(t.createName(e.name,n,e))}}),t._v(" "),i("div",{staticStyle:{height:"22vh","text-align":"center"}},[i("img",{staticClass:"image",attrs:{src:e.baseImg}})]),t._v(" "),i("div",{staticStyle:{padding:"1.5vh"}},[i("div",{staticClass:"bottom clearfix"},[i("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(i){t.previewLayout(e)}}},[t._v("展示")]),t._v(" "),i("el-button",{staticClass:"button",staticStyle:{"margin-right":"20px"},attrs:{type:"text"},on:{click:function(i){t.removeLayout(e,n)}}},[t._v("删除")])],1)])])],1)}):t._e(),t._v(" "),t.kanbanList.length||t.loading?t._e():[i("div",{staticStyle:{"padding-top":"15vh","text-align":"center","font-size":"26px"}},[i("div",{staticStyle:{display:"inline-block"}},[i("div",[t._v("没有看板，前往定制？")]),t._v(" "),i("div",{staticStyle:{"margin-top":"1vh"}},[i("el-button",{staticStyle:{"font-size":"26px"},attrs:{type:"text"},on:{click:t.createLayout}},[t._v("定制看板")])],1)])])]],2),t._v(" "),i("el-dialog",{attrs:{visible:t.dialogVisible,fullscreen:""},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.dialogVisible?i("visualizationTemplate",{tag:"component",attrs:{visualizationConfig:t.userSelectLayout},on:{closeview:t.closeview}}):t._e()],1)],1)},[],!1,null,null,null);u.options.__file="index.vue";e.default=u.exports},TD2t:function(t,e,i){"use strict";var n=i("MTY6");i.n(n).a},fcVt:function(t,e,i){},gepB:function(t,e,i){"use strict";i("yt8O"),i("RW0V"),i("Z2Ku"),i("rGqo");var n=i("k7+O"),a=i.n(n),s=i("e+jF"),o=i("MngD"),l=i("z1Gy");function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var r={name:"visualization-preview",props:{visualizationConfig:{type:Object,default:function(){return null}},showModel:{type:String,default:""}},components:function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){u(t,e,i[e])})}return t}({GridLayout:s.GridLayout,GridItem:s.GridItem,editShape:o.a},l.a),data:function(){return{layoutBoxHeight:0,layoutBoxHeightTimer:"",opacityState:!0,viewMessageDisplay:!0,screenfullAddEventd:!1,screenfullState:!1,viewMouseTimer:"",viewMouseState:!0,viewWidths:[]}},directives:{"set-view-width":{inserted:function(t,e,i){setTimeout(function(n){i.context.$set(i.context.viewWidths,e.value.index,t.offsetWidth)})}}},computed:{tempLayout:function(){return this.visualizationConfig?this.visualizationConfig.layout:[]},setRowHeight:function(){return this.layoutBoxHeight/24},setCommonStyle:function(){var t=this,e={};return this.tempLayout.forEach(function(i,n){(i.userComponents||[]).forEach(function(a){e[a.uuid]=t.getCommonStyle(a.defaultStyle,i.baseWidth,i.baseHeight,t.viewWidths[n])})}),e}},methods:{goHome:function(){this.$router.push({path:"/"})},setLayoutItemStyle:function(t){return{backgroundColor:t.backgroundColor}},viewMousemove:function(){var t=this;this.viewMouseState=!0,clearTimeout(this.viewMouseTimer),this.viewMouseTimer=setTimeout(function(e){t.viewMouseState=!1},5e3)},screenfullClick:function(t){if(!a.a.enabled)return this.$message({message:"当前浏览器不支持此功能",type:"warning"}),!1;this.screenfullAddEventd||(this.screenfullAddEventd=!0,a.a.onchange(this.resetClientHeight)),a.a.toggle(),t&&this.closeKanban()},resetClientHeight:function(){var t=this;clearTimeout(this.layoutBoxHeightTimer),this.layoutBoxHeightTimer=setTimeout(function(e){t.layoutBoxHeight=t.$el.clientHeight,t.screenfullState=a.a.isFullscreen})},closeKanban:function(){this.$emit("closeview")},scalingRatio:function(t,e){return t&&e?Math.round(this.$el.querySelector("#".concat(e)).offsetWidth/t):1},getCommonStyle:function(t,e,i,n){var a=["width","left"],s=["height","top"],o=["fontSize"],l=JSON.parse(JSON.stringify(t)),u={};for(var r in l)a.includes(r)?u[r]="".concat(l[r]/e*100,"%"):s.includes(r)?u[r]="".concat(l[r]/i*100,"%"):o.includes(r)?u[r]="".concat(l[r]*((n||e)/e),"px"):u[r]=l[r];return u.transform="rotate(".concat(u.rotate,"deg)"),u.backgroundImage=u.backgroundImage?"url(".concat(u.backgroundImage,")"):"",u}},watch:{screenfullState:function(){var t=this;this.screenfullState?(clearTimeout(this.viewMouseTimer),this.$el.addEventListener("mousemove",this.viewMousemove,!0),this.viewMouseTimer=setTimeout(function(e){t.viewMouseState=!1},5e3)):(clearTimeout(this.viewMouseTimer),this.$el.removeEventListener("mousemove",this.viewMousemove,!0),this.viewMouseState=!0,this.closeKanban())}},mounted:function(){var t=this;this.layoutBoxHeight=this.$el.clientHeight,this.$nextTick(function(e){t.opacityState=!1,setTimeout(function(e){t.screenfullClick(!1)})})},beforeDestroy:function(){clearTimeout(this.layoutBoxHeightTimer),this.screenfullAddEventd&&a.a.off("change",this.resetClientHeight),clearTimeout(this.viewMouseTimer)}},c=(i("TD2t"),i("KHd+")),h=Object(c.a)(r,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"visualizationPreview",style:{cursor:t.viewMouseState?"default":"none"}},[t.visualizationConfig?i("div",{staticClass:"visualizationPreviewView"},[i("grid-layout",{attrs:{layout:t.tempLayout,"col-num":24,"row-height":t.setRowHeight,"max-rows":24,"vertical-compact":!0,margin:[0,0],"use-css-transforms":!0},on:{"update:layout":function(e){t.tempLayout=e}}},t._l(t.tempLayout,function(e,n){return i("grid-item",{key:e.i,style:t.setLayoutItemStyle(e),attrs:{x:e.x,y:e.y,w:e.w,h:e.h,i:e.i,"is-resizable":!1,"is-draggable":!1}},[i("div",{staticStyle:{position:"relative",height:"100%"},style:{padding:(e.padding||0)+"px"}},[i("div",{directives:[{name:"set-view-width",rawName:"v-set-view-width",value:{index:n},expression:"{index}"}],staticStyle:{position:"relative",height:"100%"},style:{backgroundColor:e.childBackgroundColor}},t._l(e.userComponents||[],function(e){return i("edit-shape",{key:e.uuid,style:t.setCommonStyle[e.uuid],attrs:{uuid:e.uuid,showOnly:!0,isCustom:"custom"===e.type,defaultStyle:e.defaultStyle,active:!1,data:e}},[i(e.elName,t._b({tag:"component",staticClass:"element-on-edit-pane",attrs:{id:e.uuid},on:{"no-screenfull":function(e){t.screenfullClick(!0)}}},"component",{value:e.value,item:e,readonly:!0},!1))],1)}),1)])])}),1),t._v(" "),t.viewMessageDisplay?[i("div",{staticClass:"viewMessage",style:{opacity:t.opacityState?1:0},on:{transitionend:function(e){t.viewMessageDisplay=!t.viewMessageDisplay}}},[t._v("\n        按esc可关闭看板\n      ")])]:[i("div",{staticClass:"screenfullBtn"},[i("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:t.viewMouseState,expression:"viewMouseState"}],attrs:{content:"关闭看板",placement:"left",effect:"light"}},[i("svg-icon",{staticStyle:{"margin-left":"5px"},attrs:{"icon-class":"close","class-name":"screenfull-svg"},on:{click:function(e){t.screenfullClick(!0)}}})],1)],1)]],2):i("div",{staticStyle:{height:"100%","text-align":"center","padding-top":"200px","font-size":"30px"}},[i("div",[t._v("没有可用的配置")]),t._v(" "),i("div",[i("el-button",{on:{click:t.goHome}},[t._v("返回首页")])],1)])])},[],!1,null,"dbe809e8",null);h.options.__file="index.vue";e.a=h.exports}}]);